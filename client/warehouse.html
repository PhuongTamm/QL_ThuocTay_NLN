<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n l√Ω Kho T·ªïng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body>
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner-border text-primary" role="status"></div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-2 sidebar p-3 d-flex flex-column">
                <h4 class="text-white text-center mb-4"><i class="bi bi-hospital"></i> KHO T·ªîNG</h4>
                <nav class="nav flex-column flex-grow-1">
                    <a class="nav-link active" href="#" onclick="switchTab('medicines')"><i class="bi bi-capsule"></i> Danh m·ª•c thu·ªëc</a>
                    <a class="nav-link" href="#" onclick="switchTab('import')"><i class="bi bi-box-seam"></i> Nh·∫≠p kho (NCC)</a>
                    <a class="nav-link" href="#" onclick="switchTab('distribute')"><i class="bi bi-truck"></i> Ph√¢n ph·ªëi Chi nh√°nh</a>
                </nav>
                <div class="mt-auto">
                    <small class="text-light">Xin ch√†o, <span id="currentUserName">User</span></small>
                    <button class="btn btn-outline-light w-100 mt-2 btn-sm" onclick="logout()">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>

            <div class="col-md-10 p-4 bg-light" style="height: 100vh; overflow-y: auto;">
                
                <div id="tab-medicines" class="content-tab">
                    <div class="d-flex justify-content-between mb-3">
                        <h3>üíä Danh m·ª•c thu·ªëc</h3>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMedicineModal">
                            <i class="bi bi-plus-lg"></i> Th√™m thu·ªëc m·ªõi
                        </button>
                    </div>
                    <div class="card p-3">
                        <table class="table table-hover">
                            <thead>
                                <tr><th>M√£</th><th>T√™n thu·ªëc</th><th>ƒê∆°n v·ªã</th><th>Gi√° ni√™m y·∫øt</th><th>NSX</th></tr>
                            </thead>
                            <tbody id="medicineTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <div id="tab-import" class="content-tab d-none">
                    <h3>üì• Nh·∫≠p kho t·ª´ Nh√† Cung C·∫•p</h3>
                    <div class="card p-4 mb-3">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label>Ch·ªçn thu·ªëc</label>
                                <select id="inpImportMed" class="form-select"></select>
                            </div>
                            <div class="col-md-3">
                                <label>S·ªë l√¥ (Batch)</label>
                                <input type="text" id="inpImportBatch" class="form-control" placeholder="L001">
                            </div>
                            <div class="col-md-2">
                                <label>S·ªë l∆∞·ª£ng</label>
                                <input type="number" id="inpImportQty" class="form-control" value="100">
                            </div>
                            <div class="col-md-3">
                                <label>Gi√° nh·∫≠p</label>
                                <input type="number" id="inpImportPrice" class="form-control">
                            </div>
                            <div class="col-md-3">
                                <label>Ng√†y S·∫£n Xu·∫•t</label>
                                <input type="date" id="inpImportMfg" class="form-control">
                            </div>
                            <div class="col-md-3">
                                <label>H·∫°n S·ª≠ D·ª•ng</label>
                                <input type="date" id="inpImportExp" class="form-control">
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button onclick="addToImportList()" class="btn btn-success w-100">Th√™m d√≤ng</button>
                            </div>
                        </div>
                    </div>

                    <h5>Danh s√°ch ch·ªù nh·∫≠p:</h5>
                    <table class="table table-bordered bg-white">
                        <thead><tr><th>Thu·ªëc</th><th>L√¥</th><th>NSX - HSD</th><th>SL</th><th>Gi√°</th><th>X√≥a</th></tr></thead>
                        <tbody id="importListBody"></tbody>
                    </table>
                    <button onclick="submitImportFromSupplier()" class="btn btn-primary btn-lg float-end">Ho√†n t·∫•t Nh·∫≠p kho</button>
                </div>

                <div id="tab-distribute" class="content-tab d-none">
                    <h3>üöö Ph√¢n ph·ªëi t·ªõi Chi nh√°nh</h3>
                    <div class="alert alert-info">H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông ch·ªçn l√¥ h·∫øt h·∫°n tr∆∞·ªõc (FEFO) ƒë·ªÉ xu·∫•t.</div>
                    
                    <div class="card p-4 mb-3">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label>Ch·ªçn Chi nh√°nh nh·∫≠n</label>
                                <select id="inpDistBranch" class="form-select"></select>
                            </div>
                            <div class="col-md-4">
                                <label>Ch·ªçn thu·ªëc</label>
                                <select id="inpDistMed" class="form-select"></select>
                            </div>
                            <div class="col-md-2">
                                <label>S·ªë l∆∞·ª£ng</label>
                                <input type="number" id="inpDistQty" class="form-control" value="10">
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button onclick="addToDistList()" class="btn btn-warning w-100 text-white">Th√™m</button>
                            </div>
                        </div>
                    </div>

                    <table class="table table-bordered bg-white">
                        <thead><tr><th>Chi nh√°nh nh·∫≠n</th><th>Thu·ªëc</th><th>S·ªë l∆∞·ª£ng y√™u c·∫ßu</th><th>X√≥a</th></tr></thead>
                        <tbody id="distListBody"></tbody>
                    </table>
                    <button onclick="submitDistribution()" class="btn btn-primary btn-lg float-end">T·∫°o Phi·∫øu Xu·∫•t</button>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="addMedicineModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title">Th√™m thu·ªëc m·ªõi</h5></div>
                <div class="modal-body">
                    <input type="text" id="newMedCode" class="form-control mb-2" placeholder="M√£ thu·ªëc (V001)">
                    <input type="text" id="newMedName" class="form-control mb-2" placeholder="T√™n thu·ªëc">
                    <input type="text" id="newMedUnit" class="form-control mb-2" placeholder="ƒê∆°n v·ªã (H·ªôp/V·ªâ)">
                    <input type="number" id="newMedPrice" class="form-control mb-2" placeholder="Gi√° b√°n ni√™m y·∫øt">
                    <input type="text" id="newMedManuf" class="form-control mb-2" placeholder="Nh√† s·∫£n xu·∫•t">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="createNewMedicine()">L∆∞u</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/common.js"></script>
    <script src="js/warehouse.js"></script>
</body>
</html>